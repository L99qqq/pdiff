{
    "cfg": {
        "task": {
            "name": "classification",
            "data": {
                "data_root": "data/imagenet900",
                "dataset": "imagenet",
                "classes_used_to_train": "80-100",
                "batch_size": 32,
                "num_workers": 8,
                "group_used_to_train": "80-100"
            },
            "model": {
                "_target_": "models.resnet.ResNet18_imagenet",
                "num_classes": 20
            },
            "model_ckpt_path": null,
            "channels": "all",
            "optimizer": {
                "_target_": "torch.optim.SGD",
                "lr": 0.05,
                "momentum": 0.9,
                "weight_decay": 0.0005
            },
            "lr_scheduler": {
                "_target_": "torch.optim.lr_scheduler.MultiStepLR",
                "milestones": [
                    60,
                    120,
                    160,
                    200
                ],
                "gamma": 0.2
            },
            "random_seed_num": 1,
            "each_seed_save_num": 200,
            "train_layer": [
                "fc.weight",
                "fc.bias"
            ],
            "param": {
                "data_root": "param_data/modelzoo_imagenet_20/80_100/data.pt",
                "k": 200,
                "num_workers": 4
            }
        },
        "system": {
            "name": "ae_ddpm",
            "ae_model": {
                "_target_": "core.module.modules.encoder.big",
                "in_dim": 9216,
                "input_noise_factor": 0.001,
                "latent_noise_factor": 0.1
            },
            "ae_model_cond2": null,
            "model": {
                "arch": {
                    "_target_": "core.module.wrapper.ema.EMA",
                    "model": {
                        "_target_": "core.module.modules.unet_attention.unet_attention.UNetModel",
                        "in_dim": 16,
                        "in_channels": 112,
                        "out_channels": 112,
                        "model_channels": 64,
                        "attention_resolutions": [
                            4,
                            2,
                            1
                        ],
                        "num_res_blocks": 1,
                        "channel_mult": [
                            1,
                            2,
                            4,
                            4
                        ],
                        "num_heads": 8,
                        "use_spatial_transformer": true,
                        "transformer_depth": 1,
                        "context_dim": 16,
                        "use_checkpoint": true,
                        "legacy": false
                    }
                }
            },
            "datasets": {
                "k": 200,
                "batch_size": 32,
                "val_batch_size": 4,
                "test_batch_size": 4,
                "num_workers": 4,
                "train_dataset": {
                    "cifar100_resnet18_2conv1channel_init1_200_cifar0_44": [
                        "cifar100_resnet18_2conv1channel_init1_200_cifar0_40",
                        "cifar100_conv3_small_init1_200_cifar40_44"
                    ]
                },
                "val_dataset": null,
                "test_dataset": {
                    "cifar100_resnet18_2conv1channel_init1_200_cifar50_94": [
                        "cifar100_resnet18_2conv1channel_init1_200_cifar50_90",
                        "cifar100_conv3_small_init1_200_cifar90_94"
                    ]
                }
            },
            "beta_schedule": {
                "start": 0.0001,
                "end": 0.02,
                "schedule": "linear",
                "n_timestep": 1000
            },
            "model_mean_type": "eps",
            "model_var_type": "fixedlarge",
            "loss_type": "mse",
            "save_every_n_epoch": 1,
            "train": {
                "split_epoch": 1,
                "optimizer": {
                    "_target_": "torch.optim.AdamW",
                    "lr": 0.0001,
                    "weight_decay": 2e-06
                },
                "ae_optimizer": {
                    "_target_": "torch.optim.AdamW",
                    "lr": 0.0001,
                    "weight_decay": 2e-06
                },
                "lr_scheduler": null,
                "check_seen_val_every_n_epoch": 1,
                "test_every_n_epoch": 1,
                "trainer": {
                    "_target_": "pytorch_lightning.Trainer",
                    "_convert_": "all",
                    "max_epochs": 2,
                    "check_val_every_n_epoch": 1,
                    "log_every_n_steps": 10,
                    "limit_val_batches": 1,
                    "limit_test_batches": 1,
                    "reload_dataloaders_every_n_epochs": 1,
                    "precision": 32,
                    "enable_model_summary": true,
                    "callbacks": [
                        {
                            "_target_": "pytorch_lightning.callbacks.ModelCheckpoint",
                            "monitor": "mean_g_acc_on_unseen_train_dataset",
                            "mode": "max",
                            "save_top_k": 1,
                            "save_last": true,
                            "filename": "ddpm-{epoch}-{best_g_acc:.4f}"
                        },
                        {
                            "_target_": "pytorch_lightning.callbacks.ModelCheckpoint",
                            "filename": "ae-{epoch}-{ae_rec_acc:.4f}",
                            "monitor": "best_ae_rec_acc_on_unseen_train_dataset",
                            "mode": "max",
                            "save_top_k": 1,
                            "save_last": true,
                            "verbose": true
                        },
                        {
                            "_target_": "pytorch_lightning.callbacks.TQDMProgressBar",
                            "refresh_rate": 500
                        }
                    ],
                    "logger": {
                        "_target_": "pytorch_lightning.loggers.TensorBoardLogger",
                        "save_dir": "outputs/modelzoo_imagenet_20/80_100/ae_ddpm/",
                        "name": ".",
                        "version": "."
                    }
                }
            }
        },
        "device": {
            "cuda_visible_devices": 4,
            "id": 0,
            "cuda": "cuda:0"
        },
        "load_system_checkpoint": null,
        "mode": "train",
        "seed": 42,
        "process_title": "modelzoo_imagenet80_100",
        "output_dir": "outputs/modelzoo_imagenet_20/80_100"
    },
    "performance": [
        90.7,
        90.1,
        90.8,
        90.4,
        89.8,
        90.6,
        90.8,
        90.1,
        90.5,
        90.6,
        90.6,
        90.3,
        90.5,
        90.7,
        90.3,
        90.4,
        90.6,
        90.2,
        90.6,
        89.9,
        90.2,
        90.3,
        90.7,
        90.0,
        90.8,
        90.9,
        90.3,
        89.8,
        90.8,
        91.0,
        90.1,
        90.4,
        90.5,
        91.0,
        90.9,
        90.7,
        90.8,
        90.5,
        90.1,
        90.2,
        91.0,
        90.5,
        90.9,
        90.5,
        90.3,
        91.0,
        91.1,
        90.4,
        90.6,
        90.6,
        90.5,
        89.8,
        90.8,
        90.9,
        90.5,
        90.3,
        90.5,
        90.1,
        90.8,
        90.8,
        91.1,
        90.9,
        90.2,
        90.5,
        91.2,
        90.8,
        90.5,
        90.5,
        90.8,
        90.3,
        90.3,
        90.4,
        91.2,
        90.9,
        90.1,
        90.9,
        90.4,
        90.4,
        90.2,
        90.4,
        90.8,
        90.8,
        90.8,
        90.6,
        90.8,
        89.7,
        90.6,
        90.3,
        90.1,
        90.3,
        90.6,
        90.6,
        90.3,
        89.7,
        90.6,
        90.9,
        90.6,
        90.5,
        90.4,
        90.7,
        90.4,
        90.7,
        90.3,
        90.9,
        90.7,
        90.1,
        90.2,
        90.4,
        90.3,
        90.5,
        90.6,
        90.2,
        90.6,
        90.4,
        91.0,
        90.3,
        90.5,
        90.0,
        90.6,
        90.1,
        90.3,
        90.7,
        90.8,
        89.7,
        90.7,
        90.5,
        90.3,
        90.8,
        90.7,
        91.0,
        90.7,
        90.2,
        90.6,
        90.5,
        90.8,
        90.6,
        90.2,
        90.2,
        90.2,
        90.7,
        90.7,
        90.2,
        90.3,
        90.5,
        90.6,
        90.5,
        90.3,
        90.4,
        90.7,
        90.1,
        90.9,
        90.1,
        90.5,
        90.9,
        90.3,
        89.9,
        90.5,
        90.4,
        90.8,
        90.3,
        91.1,
        89.9,
        91.5,
        90.6,
        90.2,
        90.0,
        90.3,
        90.7,
        91.0,
        90.7,
        90.1,
        90.7,
        90.1,
        90.8,
        90.9,
        90.6,
        90.5,
        90.0,
        90.2,
        90.8,
        90.0,
        90.4,
        90.6,
        90.9,
        90.1,
        89.7,
        90.9,
        90.9,
        91.0,
        90.3,
        90.5,
        90.6,
        90.0,
        90.3,
        91.0,
        90.4,
        90.8,
        89.9,
        90.8,
        89.7
    ]
}